{# templates/settings/users.html #}
<div id="users" class="hidden">
  <h2 class="text-2xl font-semibold mb-4">Users</h2>

  <!-- Add User Form -->
  <form method="post" action="/api/users" class="space-y-4 max-w-md mb-8">
    <label class="block">
      <span class="text-gray-700 dark:text-gray-200">Username</span>
      <input type="text" name="username" required
             class="mt-1 block w-full rounded border p-2 dark:bg-gray-800 dark:text-white" />
    </label>

    <label class="block">
      <span class="text-gray-700 dark:text-gray-200">Password</span>
      <input type="password" name="password" required
             class="mt-1 block w-full rounded border p-2 dark:bg-gray-800 dark:text-white" />
    </label>

    <label class="block">
      <span class="text-gray-700 dark:text-gray-200">Role</span>
      <select name="role" class="mt-1 block w-full rounded border p-2 dark:bg-gray-800 dark:text-white">
        <option value="admin">Admin</option>
        <option value="user">User</option>
      </select>
    </label>

    <button type="submit"
            class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
      Add User
    </button>
  </form>

  <!-- User List -->
  <table class="min-w-full text-sm table-auto border">
    <thead>
      <tr class="bg-gray-100 dark:bg-gray-700 text-left">
        <th class="p-2 border">Username</th>
        <th class="p-2 border">Role</th>
        <th class="p-2 border">Actions</th>
      </tr>
    </thead>
    <tbody id="user-list">
      <!-- Filled by JS -->
    </tbody>
  </table>
</div>

<script>
  async function loadUsers() {
    const res = await fetch("/api/users");
    const users = await res.json();
    const tbody = document.getElementById("user-list");
    tbody.innerHTML = "";
    users.forEach(user => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td class="p-2 border">${user.username}</td>
        <td class="p-2 border">${user.role}</td>
        <td class="p-2 border">
          <form method="post" action="/api/users/delete" onsubmit="return confirm('Delete user ${user.username}?')">
            <input type="hidden" name="username" value="${user.username}" />
            <button type="submit" class="text-red-600 underline">Delete</button>
          </form>
        </td>`;
      tbody.appendChild(row);
    });
  }
  document.addEventListener("DOMContentLoaded", loadUsers);
</script>
